{
  "Id": "944",
  "Title": "\u0022Connecting to Azure Cosmos DB for Indexing: Best Practices\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfHighWaterMarkChangeDetectionPolicy\u0022,    \u0022  highWaterMarkColumnName\u0022: \u0022_ts\u0022    },    \u0022dataDeletionDetectionPolicy\u0022: null,    \u0022encryptionKey\u0022: null,    \u0022identity\u0022: null}Supported credentials and connection stringsIndexers can connect to a collection using the following connections.Avoid port numbers in the endpoint URL. If you include the port number, the connectionwill fail.Full access connection string{ \u0022connectionString\u0022 : \u0022AccountEndpoint=https://\u003CCosmos DB accountname\u003E.documents.azure.\r\ncom;AccountKey=\u003CCosmos DB auth key\u003E;Database=\u003CCosmos DB database id\u003E\u0022}\u0060You can get the connection string from the Azure Cosmos DB account page in the Azure portal byselecting Keys in the left navigation pane. Make sure to select a full connection string and not justa key.Managed identity connection string{ \u0022connectionString\u0022 : \u0022ResourceId=/subscriptions/\u003Cyour subscriptionID\u003E/resourceGroups/\u003Cyour resource groupname\u003E/providers/Microsoft.\r\nDocumentDB/databaseAccounts/\u003Cyour cosmos db account name\u003E/;(ApiKind=[api-kind];)/(IdentityAuthType=[identity-auth-type])\u0022 }This connection string doesn\u0027t require an account key, but you must have previously configured asearch service to connect using a managed identity. For connections that target the SQL API, youcan omit ApiKind from the connection string.\r\nFor more information about ApiKind,IdentityAuthType see Setting up an indexer connection to an Azure Cosmos DB database using amanaged identity.In the \u0022query\u0022 property under \u0022container\u0022, you can specify a SQL query to flatten nestedproperties or arrays, project JSON properties, and filter the data to be indexed. Example document:HTTPUsing queries to shape indexed data    {        \u0022userId\u0022: 10001,        \u0022contact\u0022: {            \u0022firstName\u0022: \u0022andy\u0022,            \u0022lastName\u0022: \u0022hoh\u0022        },        \u0022company\u0022: \u0022microsoft\u0022,        \u0022tags\u0022: [\u0022azure\u0022, \u0022cosmosdb\u0022, \u0022search\u0022]    }Filter query:SQLFlattening query:SQLProjection query:SQLArray flattening query:SQLQueries using the DISTINCT keyword or GROUP BY clause aren\u0027t supported.\n"
}