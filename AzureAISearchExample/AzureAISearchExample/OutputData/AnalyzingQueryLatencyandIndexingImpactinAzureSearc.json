{
  "Id": "1315",
  "Title": "\u0022Analyzing Query Latency and Indexing Impact in Azure Search\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdf\uEA80 TipTo reveal the data behind this chart, remove the line | render timechart and thenrerun the query.Impact of indexing on queriesIn the below query, an interval size of 1 minute is used to show the average latency ofthe search queries. From the chart, we can see that the average latency was low until5:45pm and lasted until 5:53pm.\r\nKustoAverage Query Latencylet intervalsize = 1m; let _startTime = datetime(\u00272021-02-23 17:40\u0027);let _endTime = datetime(\u00272021-02-23 18:00\u0027);AzureDiagnostics| where TimeGenerated between([\u0027_startTime\u0027]..[\u0027_endTime\u0027]) // Time range filtering| summarize AverageQueryLatency = avgif(DurationMs, OperationName in (\u0022Query.Search\u0022, \u0022Query.Suggest\u0022, \u0022Query.Lookup\u0022, \u0022Query.\r\nAutocomplete\u0022))    by bin(TimeGenerated, intervalsize)| render timechartAverage Queries Per Minute (QPM)The following query looks at the average number of queries per minute to ensure thatthere wasn\u0027t a spike in search requests that might have affected the latency. From thechart, we can see there\u0027s some variance, but nothing to indicate a spike in request count.\r\nKustoHere we\u0027ll look at the number of Indexing operations per minute. From the chart, we cansee that a large amount of data was indexed started at 5:42 pm and ended at 5:50pm.This indexing began 3 minutes before the search queries started becoming latent andended 3 minutes before the search queries were no longer latent. From this insight, we can see that it took about 3 minutes for the search service tobecome busy enough for indexing to affect query latency. We can also see that afterindexing completed, it took another 3 minutes for the search service to complete all thework from the newly indexed content, and for query latency to resolve.\n"
}