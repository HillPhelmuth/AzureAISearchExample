{
  "Id": "210",
  "Title": "\u0022Implementing Azure Search Functionality in React Client Application\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfappend(new_document)    return list(client_side_expected_shape)bp=func.Blueprint()@bp.function_name(\u0022search\u0022)@bp.route(route=\u0022search\u0022, methods=[func.HttpMethod.GET, func.HttpMethod.POST] )def main(req: func.HttpRequest) -\u003E func.HttpResponse:    # variables sent in body    req_body = req.get_json()    q = req_body.get(\u0022q\u0022)    top = req_body.get(\u0022top\u0022) or 8    skip = req_body.get(\u0022skip\u0022) or 0    filters = req_body.\r\nget(\u0022filters\u0022) or []    facets = environment_vars[\u0022search_facets\u0022]    facetKeys = read_facets(facets)    search_filter = \u0022\u0022    if len(filters):        search_filter = create_filter_expression(filters, facetKeys)    if q:        logging.info(f\u0022/Search q = {q}\u0022)        search_results = search_client.\r\nsearch(            search_text=q,            top=top,            skip=skip,            facets=facetKeys,            filter=search_filter,            include_total_count=True,        )        returned_docs = new_shape(search_results)        # format the React app expects        full_response = {}        full_response[\u0022count\u0022] = search_results.\r\nget_count()        full_response[\u0022facets\u0022] = search_results.get_facets()        full_response[\u0022results\u0022] = returned_docs        return func.HttpResponse(            body=json.dumps(full_response), mimetype=\u0022application/json\u0022, status_code=200        )    else:        return func.HttpResponse(\u0022No query param found. \u0022, status_code=200)Call the Azure Function in the React client with the following code.JavaScriptClient: Search from the catalogimport React, { useEffect, useState } from \u0027react\u0027;import axios from \u0027axios\u0027;import CircularProgress  from \u0027@mui/material/CircularProgress\u0027;import { useLocation, useNavigate } from \u0022react-router-dom\u0022;import Results from \u0027.\n./../components/Results/Results\u0027;import Pager from \u0027../../components/Pager/Pager\u0027;import Facets from \u0027../../components/Facets/Facets\u0027;import SearchBar from \u0027../../components/SearchBar/SearchBar\u0027;import \u0022./Search.\n"
}