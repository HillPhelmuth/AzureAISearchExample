{
  "Id": "197",
  "Title": "\u0022Automating Azure Search Index Creation and Data Upload\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfcreate_index(index)        if upload_schema:            print(f\u0022Schema uploaded; Index created for {index_name}.\u0022)        else:            exit(0)    except:        print(\u0022Unexpected error:\u0022, sys.\r\nexc_info()[0])# Convert CSV data to JSONdef convert_csv_to_json(url):    df = pd.read_csv(url)    convert = df.to_json(orient=\u0022records\u0022)    return json.loads(convert)# Batch your uploads to Azure Searchdef batch_upload_json_data_to_index(json_file, client):    batch_array = []    count = 0    batch_counter = 0    for i in json_file:        count \u002B= 1        batch_array.\r\nappend(            {                \u0022id\u0022: str(i[\u0022book_id\u0022]),                \u0022goodreads_book_id\u0022: int(i[\u0022goodreads_book_id\u0022]),                \u0022best_book_id\u0022: int(i[\u0022best_book_id\u0022]),                \u0022work_id\u0022: int(i[\u0022work_id\u0022]),                \u0022books_count\u0022: i[\u0022books_count\u0022] if i[\u0022books_count\u0022] else 0,                \u0022isbn\u0022: str(i[\u0022isbn\u0022]),                \u0022isbn13\u0022: str(i[\u0022isbn13\u0022]),                \u0022authors\u0022: i[\u0022authors\u0022].\r\nsplit(\u0022,\u0022) if i[\u0022authors\u0022] else None,                \u0022original_publication_year\u0022: int(i[\u0022original_publication_year\u0022])                if i[\u0022original_publication_year\u0022]                else 0,                \u0022original_title\u0022: i[\u0022original_title\u0022],                \u0022title\u0022: i[\u0022title\u0022],                \u0022language_code\u0022: i[\u0022language_code\u0022],                \u0022average_rating\u0022: int(i[\u0022average_rating\u0022])                if i[\u0022average_rating\u0022]                else 0,                \u0022ratings_count\u0022: int(i[\u0022ratings_count\u0022]) if i[\u0022ratings_count\u0022] else 0,                \u0022work_ratings_count\u0022: int(i[\u0022work_ratings_count\u0022])                if i[\u0022work_ratings_count\u0022]                else 0,                \u0022work_text_reviews_count\u0022: i[\u0022work_text_reviews_count\u0022]                if i[\u0022work_text_reviews_count\u0022]                else 0,                \u0022ratings_1\u0022: int(i[\u0022ratings_1\u0022]) if i[\u0022ratings_1\u0022] else 0,                \u0022ratings_2\u0022: int(i[\u0022ratings_2\u0022]) if i[\u0022ratings_2\u0022] else 0,2.\n"
}