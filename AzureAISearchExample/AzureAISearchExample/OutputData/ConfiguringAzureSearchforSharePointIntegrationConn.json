{
  "Id": "1004",
  "Title": "\u0022Configuring Azure Search for SharePoint Integration: Connection String Formats\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfHTTPThe format of the connection string changes based on whether the indexer is using delegated API permissions or application APIpermissionsDelegated API permissions connection string formatSharePointOnlineEndpoint=[SharePoint site url];ApplicationId=[Azure AD App ID];TenantId=[SharePoint site tenant id]Application API permissions connection string formatSharePointOnlineEndpoint=[SharePoint site url];ApplicationId=[Azure AD App ID];ApplicationSecret=[Azure AD App clientsecret];TenantId=[SharePoint site tenant id]The index specifies the fields in a document, attributes, and other constructs that shape the search experience.\r\nTo create an index, call Create Index (preview):HTTPPOST https://[service name].search.windows.\r\nnet/datasources?api-version=2023-10-01-PreviewContent-Type: application/jsonapi-key: [admin key]{    \u0022name\u0022 : \u0022sharepoint-datasource\u0022,    \u0022type\u0022 : \u0022sharepoint\u0022,    \u0022credentials\u0022 : { \u0022connectionString\u0022 : \u0022[connection-string]\u0022 },    \u0022container\u0022 : { \u0022name\u0022 : \u0022defaultSiteLibrary\u0022, \u0022query\u0022 : null }}Connection string format\uFF17 NoteIf the SharePoint site is in the same tenant as the search service and system-assigned managed identity is enabled, TenantId doesn\u0027thave to be included in the connection string.\r\nIf the SharePoint site is in a different tenant from the search service, TenantId must beincluded. Step 5: Create an indexPOST https://[service name].search.windows.net/indexes?api-version=2023-10-01-PreviewContent-Type: application/jsonapi-key: [admin key]{    \u0022name\u0022 : \u0022sharepoint-index\u0022,    \u0022fields\u0022: [        { \u0022name\u0022: \u0022id\u0022, \u0022type\u0022: \u0022Edm.String\u0022, \u0022key\u0022: true, \u0022searchable\u0022: false },        { \u0022name\u0022: \u0022metadata_spo_item_name\u0022, \u0022type\u0022: \u0022Edm.\n"
}