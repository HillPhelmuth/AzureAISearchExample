{
  "Id": "1356",
  "Title": "\u0022Logging User-Generated Search Queries in Azure Search Service\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfSearch var client = new SearchIndexClient(\u003CSearchServiceName\u003E, \u003CIndexName\u003E, new SearchCredentials(\u003CQueryKey\u003E)); // Use HTTP headers so that you can get the search ID from the response var headers = new Dictionary\u003Cstring, List\u003Cstring\u003E\u003E() { { \u0022x-ms-azs-return-searchid\u0022, new List\u003Cstring\u003E() { \u0022true\u0022 } } }; var response = await client.Documents.\r\nSearchWithHttpMessagesAsync(searchText: searchText, searchParameters: parameters, customHeaders: headers); string searchId = string.Empty; if (response.Response.Headers.TryGetValues(\u0022x-ms-azs-searchid\u0022, out IEnumerable\u003Cstring\u003E headerValues)) {     searchId = headerValues.FirstOrDefault(); } request.setRequestHeader(\u0022x-ms-azs-return-searchid\u0022, \u0022true\u0022); request.\r\nsetRequestHeader(\u0022Access-Control-Expose-Headers\u0022, \u0022x-ms-azs-Every time that a search request is issued by a user, you should log that as a searchevent with the following schema on an Application Insights custom event. Remember tolog only user-generated search queries.\r\nSearchServiceName: (string) search service nameSearchId: (guid) unique identifier of the search query (comes in the searchresponse)IndexName: (string) search service index to be queriedQueryTerms: (string) search terms entered by the userResultCount: (int) number of documents that were returned (comes in the searchresponse)ScoringProfile: (string) name of the scoring profile used, if anyUse C#C#Use JavaScriptJavaScriptsearchid\u0022); var searchId = request. getResponseHeader(\u0027x-ms-azs-searchid\u0027); Step 3: Log Search events\uFF17 NoteRequest the count of user generated queries by adding $count=true to your searchquery. For more information, see Search Documents (REST).var properties = new Dictionary \u003Cstring, string\u003E  {     {\u0022SearchServiceName\u0022, \u003Cservice name\u003E},     {\u0022SearchId\u0022, \u003Csearch Id\u003E},     {\u0022IndexName\u0022, \u003Cindex name\u003E},     {\u0022QueryTerms\u0022, \u003Csearch terms\u003E},     {\u0022ResultCount\u0022, \u003Cresults count\u003E},     {\u0022ScoringProfile\u0022, \u003Cscoring profile used\u003E} }; _telemetryClient.\n"
}