{
  "Id": "189",
  "Title": "\u0022JavaScript Azure Function: Retrieving Specific Document in React App\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdfJavaScriptAzure Function: Get specific documentconst { SearchClient, AzureKeyCredential } = require(\u0022@azure/search-documents\u0022);const { app } = require(\u0027@azure/functions\u0027);const { CONFIG } = require(\u0022../lib/config\u0022);// Create a SearchClient to send queriesconst client = new SearchClient(    \u0060https://\u0060 \u002B CONFIG.SearchServiceName \u002B \u0060.search.windows.net/\u0060,    CONFIG.SearchIndexName,    new AzureKeyCredential(CONFIG.SearchApiQueryKey));app.\r\nhttp(\u0027lookup\u0027, {    methods: [\u0027GET\u0027],    authLevel: \u0027anonymous\u0027,    handler: async (request, context) =\u003E {        context.log(\u0060Lookup processed request for url \u0022${request.url}\u0022\u0060);        try {            const id = request.query.get(\u0027id\u0027);            console.log(id);            if (!id) {                return {                    status: 404                }            }This function API is called in the React app at \\src\\pages\\Details\\Detail.\r\njs as part ofcomponent initialization:JavaScript            const document = await client.getDocument(id);            return { jsonBody: { document: document } };        } catch (error) {            return {                status: 400,                jsonBody: {                    innerStatusCode: error.\r\nstatusCode || error.code,                    error: error.details || error.message                }            }        }    }});Client: Get specific documentimport React, { useState } from \u0022react\u0022;import { useParams } from \u0027react-router-dom\u0027;import CircularProgress from \u0027@mui/material/CircularProgress\u0027;import Container from \u0027@mui/material/Container\u0027;import request from \u0027. ./api\u0027;import BookDetailsTab from \u0022../components/BookDetail/DetailPage/booktab\u0022;import {  useQuery,} from \u0027@tanstack/react-query\u0027export default function Details() {  let { id } = useParams();  const [document, setDocument] = useState({});  const lookupRequest = () =\u003E request(\u0027/api/lookup?id=\u0027 \u002B id, \u0022GET\u0022).\n"
}