{
  "Id": "943",
  "Title": "\u0022Configuring CosmosDB Data Source for Azure Search Indexing\u0022",
  "Text": "C:\\Users\\adamh\\Downloads\\azure-search.pdf1. Create or update a data source to set its definition:PrerequisitesDefine the data sourceHTTP2. Set \u0022type\u0022 to \u0022cosmosdb\u0022 (required). If you\u0027re using an older Search API version2017-11-11, the syntax for \u0022type\u0022 is \u0022documentdb\u0022. Otherwise, for 2019-05-06 andlater, use \u0022cosmosdb\u0022.3. Set \u0022credentials\u0022 to a connection string.\r\nThe next section describes the supportedformats.4. Set \u0022container\u0022 to the collection. The \u0022name\u0022 property is required and it specifiesthe ID of the database collection to be indexed. The \u0022query\u0022 property is optional.Use it to flatten an arbitrary JSON document into a flat schema that Azure AISearch can index.\r\n5. Set \u0022dataChangeDetectionPolicy\u0022 if data is volatile and you want the indexer topick up just the new and updated items on subsequent runs.6. Set \u0022dataDeletionDetectionPolicy\u0022 if you want to remove search documents from asearch index when the source item is deleted.POST https://[service name].\r\nsearch.windows.net/datasources?api-version=2020-06-30Content-Type: application/jsonapi-key: [Search service admin key]{    \u0022name\u0022: \u0022[my-cosmosdb-ds]\u0022,    \u0022type\u0022: \u0022cosmosdb\u0022,    \u0022credentials\u0022: {      \u0022connectionString\u0022: \u0022AccountEndpoint=https://[cosmos-account-name].documents.azure.\r\ncom;AccountKey=[cosmos-account-key];Database=[cosmos-database-name]\u0022    },    \u0022container\u0022: {      \u0022name\u0022: \u0022[my-cosmos-db-collection]\u0022,      \u0022query\u0022: null    },    \u0022dataChangeDetectionPolicy\u0022: {      \u0022@odata.type\u0022: \u0022#Microsoft.Azure.Search. HighWaterMarkChangeDetectionPolicy\u0022,    \u0022  highWaterMarkColumnName\u0022: \u0022_ts\u0022    },    \u0022dataDeletionDetectionPolicy\u0022: null,    \u0022encryptionKey\u0022: null,    \u0022identity\u0022: null}Supported credentials and connection stringsIndexers can connect to a collection using the following connections.Avoid port numbers in the endpoint URL. If you include the port number, the connectionwill fail.Full access connection string{ \u0022connectionString\u0022 : \u0022AccountEndpoint=https://\u003CCosmos DB accountname\u003E.documents.azure.\n"
}